<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorpresa</title>
<style>
  body{margin:0;background:black;overflow:hidden;font-family:'Courier New',monospace;}
  /* Pantallas base */
  .screen{position:fixed;top:0;left:0;width:100%;height:100%;background:black;
    display:none;flex-direction:column;align-items:center;justify-content:center;z-index:20;}
  .btn{margin:10px;padding:12px 25px;font-size:1.1rem;background:#ff69b4;
    color:white;border:none;border-radius:12px;cursor:pointer;
    box-shadow:0 0 15px #ff69b4;}
  h2{color:#ff69b4;text-align:center;margin-bottom:20px;}
  /* Inicio */
  #inicio{z-index:30;background:linear-gradient(to top,#000,#330033);
    color:white;text-align:center;display:flex;flex-direction:column;}
  #inicio button{padding:20px 40px;font-size:1.5rem;
    background:#ff69b4;color:white;border:none;border-radius:15px;
    cursor:pointer;box-shadow:0 0 20px #ff69b4;margin-top:20px;}
  /* Contadores */
  #contador{position:absolute;top:10px;left:50%;transform:translateX(-50%);
    color:white;font-size:1.2rem;z-index:4;background:rgba(0,0,0,0.4);
    padding:8px 40px;border-radius:10px;text-align:center;min-width:280px;display:none;}
  #tiempoTotal{position:fixed;bottom:10px;left:50%;transform:translateX(-50%);
    color:#ff69b4;font-size:1.1rem;z-index:11;background:rgba(0,0,0,0.4);
    padding:8px 15px;border-radius:10px;text-align:center;white-space:pre-line;display:none;}
  /* Pantalla principal */
  .overlay{position:absolute;top:0;left:0;width:100%;height:100%;
    z-index:2;display:none;flex-direction:column;align-items:center;justify-content:center;pointer-events:none;}
  .center-image{width:200px;border-radius:10px;margin-bottom:20px;box-shadow:0 0 20px #ff69b4;}
  .center-message{color:#ff69b4;font-size:2rem;text-align:center;}
  #listaRecuerdos{display:none;list-style:none;margin-top:15px;padding:0;color:white;text-align:center;}
  .final-message{position:absolute;top:40%;left:50%;
    transform:translate(-50%,-50%);font-size:2rem;color:white;
    text-shadow:2px 2px 4px #000,-1px -1px 2px #ff69b4;
    z-index:3;text-align:center;display:none;}
  /* Recuerdos */
  #recuerdosContent ul{list-style:none;padding:0;margin-bottom:20px;color:white;font-size:1.1rem;text-align:center;}
  /* Confeti */
  #confetiCanvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:100;}
  #confetiMensaje{position:fixed;top:50%;left:50%;
    transform:translate(-50%,-50%);background:rgba(255,255,255,0.9);
    color:#ff69b4;font-size:2rem;font-weight:bold;text-align:center;
    padding:30px 40px;border-radius:20px;box-shadow:0 0 30px #ff69b4;z-index:101;display:none;}
</style>
</head>
<body>

<!-- Pantalla de inicio -->
<div id="inicio" class="screen" style="display:flex;">
  <h1>ğŸ Tengo algo especial para ti</h1>
  <button onclick="iniciarSorpresa()">Haz clic para abrir</button>
</div>

<!-- Pantalla principal -->
<div id="contador"></div>
<div id="tiempoTotal"></div>
<div class="overlay" id="contenido">
  <img src="imagen.jpg" alt="Foto juntos" class="center-image" />
  <div class="center-message">TE AMO â¤ï¸</div>
  <button id="btnRecuerdos" class="btn" style="pointer-events:auto;">ğŸ’Œ Nuestros recuerdos</button>
  <button id="btnFotos" class="btn" style="pointer-events:auto;">ğŸ“· Nuestras fotos</button>
</div>
<div class="final-message" id="finalMessage">Gracias por dejarme formar parte de tu vidaâ¤ï¸</div>

<!-- Recuerdos -->
<div id="recuerdosScreen" class="screen">
  <canvas id="canvasRecuerdos"></canvas>
  <div id="recuerdosContent">
    <h2>Nuestros Recuerdos</h2>
    <ul>
      <li>15 de julio 2023 â€“ Nuestro reencuentro ğŸ’–</li>
      <li>21 de julio 2023 â€“ Primera salida âœ¨</li>
    </ul>
    <button id="btnMiniJuego" class="btn">ğŸ® Mini-juego</button>
    <button id="btnFechas" class="btn">ğŸ“… Fechas especiales</button>
    <button id="btnRegresarRecuerdos" class="btn">â¬…ï¸ Regresar</button>
  </div>
</div>

<!-- Fotos -->
<div id="fotosScreen" class="screen">
  <canvas id="canvasFotos"></canvas>
  <div>
    <h2>Nuestras Fotos</h2>
    <button id="btnRegresarFotos" class="btn">â¬…ï¸ Regresar</button>
  </div>
</div>

<!-- Mini-juego -->
<div id="miniJuegoScreen" class="screen">
  <h2>ğŸ® Mini-juego de recuerdos</h2>
  <p style="color:white;">AquÃ­ irÃ¡ el rompecabezas o juego que quieras agregar.</p>
  <button id="btnRegresarMiniJuego" class="btn">â¬…ï¸ Regresar</button>
</div>

<!-- Fechas especiales -->
<div id="fechasScreen" class="screen">
  <h2>ğŸ“… Fechas especiales</h2>
  <p style="color:white;">Cuenta regresiva y eventos especiales aparecerÃ¡n aquÃ­.</p>
  <button id="btnCarta" class="btn">ğŸ’Œ Carta secreta</button>
  <button id="btnRegresarFechas" class="btn">â¬…ï¸ Regresar</button>
</div>

<!-- Confeti -->
<canvas id="confetiCanvas"></canvas>
<div id="confetiMensaje"></div>

<audio id="musica" loop>
  <source src="musica.mp3" type="audio/mpeg">
</audio>
<canvas id="canvas"></canvas>

<script>
let lluviaPrincipalIniciada=false;
function iniciarSorpresa(){
  document.getElementById('inicio').style.display='none';
  document.getElementById('contenido').style.display='flex';
  document.getElementById('contador').style.display='block';
  document.getElementById('tiempoTotal').style.display='block';
  document.getElementById('musica').play();
  calcularDiasJuntos();
  iniciarTiempoTotal();
  if(!lluviaPrincipalIniciada){ iniciarAnimacion(); lluviaPrincipalIniciada=true; }
  checkFechasEspeciales();
}
function calcularDiasJuntos(){
  const inicio=new Date("2023-08-11T20:00:00");
  const hoy=new Date();
  const diff=hoy-inicio;
  const dias=Math.floor(diff/(1000*60*60*24));
  document.getElementById("contador").innerText=`Llevamos ${dias} dÃ­as juntosğŸ’–`;
}
function iniciarTiempoTotal(){
  const inicio=new Date("2023-08-11T20:00:00");
  function actualizar(){
    const ahora=new Date();
    let aÃ±os=ahora.getFullYear()-inicio.getFullYear();
    let meses=ahora.getMonth()-inicio.getMonth();
    let dias=ahora.getDate()-inicio.getDate();
    if(dias<0){meses--;dias+=new Date(ahora.getFullYear(),ahora.getMonth(),0).getDate();}
    if(meses<0){aÃ±os--;meses+=12;}
    const diffMs=ahora-inicio;
    const horas=Math.floor((diffMs/(1000*60*60))%24);
    const minutos=Math.floor((diffMs/(1000*60))%60);
    const segundos=Math.floor((diffMs/1000)%60);
    document.getElementById("tiempoTotal").innerText=
      `AÃ±os: ${aÃ±os} | Meses: ${meses} | DÃ­as: ${dias}\n`+
      `Tiempo juntos: ${horas}h ${minutos}m ${segundos}s`;
  }
  actualizar(); setInterval(actualizar,1000);
}
function iniciarAnimacion(){
  const canvas=document.getElementById('canvas');
  const ctx=canvas.getContext('2d');
  canvas.width=innerWidth; canvas.height=innerHeight;
  ctx.font="16px monospace";
  const drops=new Array(Math.floor(canvas.width/32)).fill(1);
  function draw(){
    ctx.fillStyle="rgba(0,0,0,0.1)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#ff69b4";
    drops.forEach((drop,i)=>{
      const x=i*32, y=drop*12;
      ctx.fillText("TE AMO",x,y);
      if(y>canvas.height && Math.random()>0.98) drops[i]=0;
      drops[i]+=0.7;
    });
    requestAnimationFrame(draw);
  }
  draw();
  lanzarExplosionYFrase(ctx,canvas);
}
function lanzarExplosionYFrase(ctx,canvas){
  setTimeout(()=>{
    const particles=[];
    for(let t=0;t<Math.PI*2;t+=0.02){
      const x=16*Math.pow(Math.sin(t),3);
      const y=13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t);
      const angle=Math.atan2(y,x);
      const speed=2+Math.random()*2;
      particles.push({x:canvas.width/2,y:canvas.height/2,
        vx:Math.cos(angle)*speed*10,vy:-Math.sin(angle)*speed*10,alpha:1});
    }
    function animate(){
      ctx.fillStyle="rgba(0,0,0,0.2)";
      ctx.fillRect(0,0,canvas.width,canvas.height);
      particles.forEach(p=>{
        ctx.fillStyle=`rgba(255,105,180,${p.alpha})`;
        ctx.fillText("TE AMO",p.x,p.y);
        p.x+=p.vx; p.y+=p.vy; p.alpha-=0.01;
      });
      if(particles[0].alpha>0) requestAnimationFrame(animate);
      else document.getElementById('finalMessage').style.display='block';
    }
    animate();
  },1000);
}

/* ----- Manejo de pantallas ----- */
const screens={
  main:'contenido', recuerdos:'recuerdosScreen', fotos:'fotosScreen',
  mini:'miniJuegoScreen', fechas:'fechasScreen'
};
function show(id){
  Object.values(screens).forEach(s=>document.getElementById(s).style.display='none');
  if(id==='main'){
    document.getElementById(screens.main).style.display='flex';
    document.getElementById('contador').style.display='block';
    document.getElementById('tiempoTotal').style.display='block';
  }else{
    document.getElementById(screens[id]).style.display='flex';
  }
}

document.getElementById('btnRecuerdos').onclick=()=>{show('recuerdos');iniciarLluviaRecuerdos();};
document.getElementById('btnFotos').onclick=()=>{show('fotos');};
document.getElementById('btnRegresarRecuerdos').onclick=()=>{show('main');};
document.getElementById('btnRegresarFotos').onclick=()=>{show('main');};
document.getElementById('btnMiniJuego').onclick=()=>{show('mini');};
document.getElementById('btnRegresarMiniJuego').onclick=()=>{show('recuerdos');};
document.getElementById('btnFechas').onclick=()=>{show('fechas');};
document.getElementById('btnRegresarFechas').onclick=()=>{show('recuerdos');};
document.getElementById('btnCarta').onclick=()=>{alert("AquÃ­ puedes mostrar la carta secreta â¤ï¸");};

function iniciarLluviaRecuerdos(){
  const canvas=document.getElementById('canvasRecuerdos');
  const ctx=canvas.getContext('2d');
  canvas.width=innerWidth; canvas.height=innerHeight;
  ctx.font="16px monospace";
  const drops=new Array(Math.floor(canvas.width/32)).fill(1);
  function draw(){
    ctx.fillStyle="rgba(0,0,0,0.1)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#ff69b4";
    drops.forEach((drop,i)=>{
      const x=i*32, y=drop*12;
      ctx.fillText("TE AMO",x,y);
      if(y>canvas.height && Math.random()>0.98) drops[i]=0;
      drops[i]+=0.7;
    });
    if(document.getElementById('recuerdosScreen').style.display==='flex')
      requestAnimationFrame(draw);
  }
  draw();
}

/* ----- Confeti en fechas especiales ----- */
function checkFechasEspeciales(){
  const hoy=new Date();
  const d=hoy.getDate();
  const m=hoy.getMonth();
  let mensaje=null;
  if(d===25){ mensaje="Feliz otro mes mÃ¡s juntos ğŸ’–"; }
  if(d===11){ mensaje="Feliz otro mes mÃ¡s juntos ğŸ’–"; }
  if(d===11 && m===7){ mensaje="ğŸ‰ Feliz aniversario ğŸ’–"; }
  if(d===8 && m===6){ mensaje="ğŸ‚ Feliz cumpleaÃ±os amor ğŸ’–"; }
  if(d===10 && m===1){ mensaje="ğŸ‚ Feliz cumpleaÃ±os ğŸ‰"; }
  if(mensaje) lanzarConfeti(mensaje);
}
function lanzarConfeti(mensaje){
  const canvas=document.getElementById('confetiCanvas');
  const ctx=canvas.getContext('2d');
  const msg=document.getElementById('confetiMensaje');
  canvas.width=innerWidth; canvas.height=innerHeight;
  msg.innerText=mensaje; msg.style.display='block';
  const confetis=[];
  for(let i=0;i<200;i++){
    confetis.push({
      x:Math.random()*canvas.width,y:Math.random()*canvas.height,
      r:Math.random()*6+4,dx:Math.random()*2-1,dy:Math.random()*2+1,
      color:`hsl(${Math.random()*360},100%,50%)`
    });
  }
  let start=performance.now();
  function draw(now){
    const elapsed=now-start;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    confetis.forEach(c=>{
      ctx.beginPath();
      ctx.arc(c.x,c.y,c.r,0,Math.PI*2);
      ctx.fillStyle=c.color;
      ctx.fill();
      c.x+=c.dx; c.y+=c.dy;
      if(c.y>canvas.height){c.y=-c.r;}
      if(c.x>canvas.width||c.x<-c.r){c.x=Math.random()*canvas.width;}
    });
    if(elapsed<5000){ requestAnimationFrame(draw); }
    else{ ctx.clearRect(0,0,canvas.width,canvas.height); msg.style.display='none'; }
  }
  requestAnimationFrame(draw);
}
</script>
</body>
</html>
